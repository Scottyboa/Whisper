<!DOCTYPE html>
            alert("Error uploading file: " + error);
          }
        };
      }
    });

    document.getElementById("transcribeButton").addEventListener("click", async () => {
      const apiKey = localStorage.getItem("openai_api_key");
      if (!apiKey) {
        alert("API key is missing. Please enter your API key on the login page.");
        return;
      }
      if (!sessionId) {
        alert("No recording found. Please record and stop first.");
        return;
      }

      try {
        const response = await fetch(`${backendUrl}/transcribe`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ api_key: apiKey, session_id: sessionId })
        });
        const result = await response.json();
        if (result.transcription) {
          document.getElementById("transcription").innerText = result.transcription;
        } else {
          alert("Transcription error: " + (result.error || "Unknown error"));
        }
      } catch (error) {
        alert("Error during transcription: " + error);
      }
    });

    document.getElementById("deleteButton").addEventListener("click", deleteRecording);

    function deleteRecording() {
      fetch(`${backendUrl}/delete`, { method: "DELETE" })
        .then(response => response.json())
        .then(result => {
          alert(result.message || result.error);
          sessionId = "";
        })
        .catch(error => alert("Error deleting recording: " + error));
    }
  </script>
</body>
</html>
